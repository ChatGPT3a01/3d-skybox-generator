<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº®è¨€~3Dç’°æ™¯çƒç”Ÿæˆå™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        /* å•Ÿå‹•ç•«é¢ */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0a0e27;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            animation: fadeOut 0.5s ease-out 3.5s forwards;
        }
        @keyframes fadeOut {
            to {
                opacity: 0;
                visibility: hidden;
            }
        }
        .splash-logo {
            width: 90%;
            max-width: 1200px;
            height: auto;
            margin-bottom: 60px;
            animation: logoGlow 2s ease-in-out infinite;
        }
        @keyframes logoGlow {
            0%, 100% {
                filter: drop-shadow(0 0 20px rgba(100, 200, 255, 0.6));
            }
            50% {
                filter: drop-shadow(0 0 40px rgba(100, 200, 255, 0.9));
            }
        }
        .progress-container {
            width: 80%;
            max-width: 600px;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00d4ff, #7b2ff7, #f107a3);
            border-radius: 10px;
            animation: progressLoad 4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            position: relative;
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.8);
        }
        @keyframes progressLoad {
            0% {
                width: 0%;
            }
            100% {
                width: 100%;
            }
        }
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.5), transparent);
            animation: shimmer 1.5s infinite;
        }
        @keyframes shimmer {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(100%);
            }
        }
        .loading-text {
            color: #00d4ff;
            font-size: 18px;
            margin-top: 20px;
            letter-spacing: 2px;
            animation: pulse 1.5s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% {
                opacity: 0.6;
            }
            50% {
                opacity: 1;
            }
        }
        /* ä¸»å…§å®¹åˆå§‹éš±è— */
        #main-content {
            opacity: 0;
            animation: fadeIn 0.8s ease-in 4s forwards;
        }
        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }
        .container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            max-width: 800px;
            width: 100%;
        }
        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
            text-align: center;
        }
        .subtitle {
            color: #666;
            text-align: center;
            margin-bottom: 30px;
            font-size: 14px;
        }
        .workflow {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
        }
        .workflow h3 {
            font-size: 16px;
            margin-bottom: 15px;
        }
        .workflow-steps {
            display: flex;
            justify-content: space-between;
            gap: 15px;
        }
        .workflow-step {
            flex: 1;
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .workflow-step-num {
            background: white;
            color: #667eea;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin: 0 auto 10px;
        }
        .workflow-step-text {
            font-size: 13px;
            line-height: 1.5;
        }
        .sample-status {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
        }
        .sample-status h3 {
            color: #667eea;
            font-size: 16px;
            margin-bottom: 15px;
        }
        .file-status-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        .file-status-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            text-align: center;
            transition: all 0.3s;
        }
        .file-status-card.loaded {
            border-color: #4caf50;
            background: #f1f8f4;
        }
        .file-status-card.error {
            border-color: #f44336;
            background: #fef1f0;
        }
        .file-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }
        .file-name {
            font-size: 13px;
            color: #666;
            margin-bottom: 5px;
            word-break: break-all;
        }
        .file-status-text {
            font-size: 12px;
            font-weight: 600;
        }
        .file-status-card.loaded .file-status-text {
            color: #4caf50;
        }
        .file-status-card.error .file-status-text {
            color: #f44336;
        }
        .upload-section {
            margin-bottom: 25px;
        }
        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            background: #f8f9ff;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
        }
        .upload-area:hover {
            background: #f0f2ff;
            border-color: #764ba2;
        }
        .upload-area.dragover {
            background: #e8ebff;
            border-color: #764ba2;
        }
        #fileInput {
            display: none;
        }
        .upload-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        .upload-text {
            color: #667eea;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        .upload-hint {
            color: #999;
            font-size: 13px;
        }
        .preview-section {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: none;
        }
        .preview-section h3 {
            color: #667eea;
            font-size: 16px;
            margin-bottom: 15px;
        }
        .preview-image {
            width: 100%;
            max-height: 300px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .image-info {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            background: white;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .image-info-item {
            font-size: 13px;
            color: #666;
        }
        .image-info-item strong {
            color: #333;
        }
        .btn {
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .btn-secondary {
            background: #f5f5f5;
            color: #666;
            font-size: 14px;
            padding: 12px;
        }
        .btn-secondary:hover {
            background: #e8e8e8;
        }
        .status {
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-weight: 500;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }
        .status.processing {
            background: #fff3cd;
            color: #856404;
            border: 2px solid #ffeaa7;
        }
        .instructions {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
            border-left: 4px solid #667eea;
        }
        .instructions h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 16px;
        }
        .instructions ol {
            margin-left: 20px;
            color: #666;
            font-size: 14px;
            line-height: 1.8;
        }
        .instructions ol li {
            margin-bottom: 8px;
        }
        /* ä½œè€…è³‡è¨Šå€ */
        .author-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 12px;
            margin-top: 30px;
            color: white;
        }
        .author-content {
            display: flex;
            gap: 30px;
            align-items: center;
            margin-bottom: 20px;
        }
        .author-image {
            width: 200px;
            height: auto;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        .author-info h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: white;
        }
        .author-info p {
            font-size: 14px;
            line-height: 1.8;
            margin-bottom: 8px;
            opacity: 0.95;
        }
        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        .social-link {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 20px;
            text-decoration: none;
            color: white;
            font-size: 14px;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        .social-link:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        /* æˆæ¬Šè²æ˜ */
        .license-section {
            background: #fff9e6;
            border: 2px solid #ffd700;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .license-section h4 {
            color: #b8860b;
            font-size: 16px;
            margin-bottom: 10px;
        }
        .license-section p {
            color: #666;
            font-size: 14px;
            line-height: 1.8;
            margin-bottom: 8px;
        }
        .license-section .copyright {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        .license-section .warning {
            color: #d32f2f;
            font-weight: 600;
            margin-top: 10px;
        }
        .license-section ul {
            margin-left: 20px;
            color: #666;
            font-size: 14px;
            line-height: 1.6;
        }
        @media (max-width: 768px) {
            .author-content {
                flex-direction: column;
            }
            .author-image {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <!-- å•Ÿå‹•ç•«é¢ -->
    <div id="splash-screen">
        <img src="logo.png" alt="äº®è¨€~3Dç’°æ™¯çƒç”Ÿæˆå™¨" class="splash-logo">
        <div class="progress-container">
            <div class="progress-bar"></div>
        </div>
        <div class="loading-text">ç³»çµ±è¼‰å…¥ä¸­...</div>
    </div>

    <!-- ä¸»è¦å…§å®¹ -->
    <div id="main-content">
    <div class="container">
        <h1>ğŸŒ äº®è¨€~3Dç’°æ™¯çƒç”Ÿæˆå™¨</h1>
        <p class="subtitle">ä¸Šå‚³ 360Â° å…¨æ™¯åœ–ï¼Œä¸€éµç”Ÿæˆ VR ç’°æ™¯çƒ GLB æª”æ¡ˆ</p>

        <div class="workflow">
            <h3>âš¡ ç°¡å–®ä¸‰æ­¥é©Ÿ</h3>
            <div class="workflow-steps">
                <div class="workflow-step">
                    <div class="workflow-step-num">1</div>
                    <div class="workflow-step-text">ä¸Šå‚³æ‚¨çš„ <strong>360Â° å…¨æ™¯åœ–</strong></div>
                </div>
                <div class="workflow-step">
                    <div class="workflow-step-num">2</div>
                    <div class="workflow-step-text">ç¢ºèª<strong>é è¦½</strong>æ­£ç¢º</div>
                </div>
                <div class="workflow-step">
                    <div class="workflow-step-num">3</div>
                    <div class="workflow-step-text">é»æ“Š<strong>ç”Ÿæˆ GLB</strong></div>
                </div>
            </div>
        </div>

        <div class="sample-status">
            <h3>ğŸ“¦ ç’°æ™¯çƒæ¨¡æ¿ç‹€æ…‹</h3>
            <div class="file-status-grid">
                <div class="file-status-card" id="gltfStatus">
                    <div class="file-icon">ğŸ“„</div>
                    <div class="file-name">Spatial Skybox Sample.gltf</div>
                    <div class="file-status-text">æª¢æŸ¥ä¸­...</div>
                </div>
                <div class="file-status-card" id="binStatus">
                    <div class="file-icon">ğŸ’¾</div>
                    <div class="file-name">Spatial Skybox Sample.bin</div>
                    <div class="file-status-text">æª¢æŸ¥ä¸­...</div>
                </div>
            </div>
        </div>

        <div class="upload-section">
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">ğŸ–¼ï¸</div>
                <div class="upload-text">ä¸Šå‚³æ‚¨çš„ 360Â° å…¨æ™¯åœ–</div>
                <div class="upload-hint">é»æ“Šæˆ–æ‹–æ›³ä¸Šå‚³ JPGã€PNG åœ–ç‰‡</div>
                <input type="file" id="fileInput" accept="image/jpeg,image/jpg,image/png">
            </div>
        </div>

        <div class="preview-section" id="previewSection">
            <h3>ğŸ–¼ï¸ åœ–ç‰‡é è¦½</h3>
            <img id="previewImage" class="preview-image" alt="é è¦½åœ–">
            <div class="image-info">
                <div class="image-info-item">
                    <strong>æª”åï¼š</strong><span id="imageName"></span>
                </div>
                <div class="image-info-item">
                    <strong>å¤§å°ï¼š</strong><span id="imageSize"></span>
                </div>
            </div>

            <button class="btn btn-primary" id="convertBtn">
                <span style="font-size: 24px;">ğŸš€</span>
                <span>ç”Ÿæˆ GLB æª”æ¡ˆ</span>
            </button>

            <button class="btn btn-secondary" id="changeImageBtn">
                æ›´æ›åœ–ç‰‡
            </button>
        </div>

        <div class="status" id="status" style="display: none;"></div>

        <div class="instructions">
            <h3>ğŸ“– ä½¿ç”¨èªªæ˜</h3>
            <ol>
                <li><strong>å•Ÿå‹•æœ¬åœ°ä¼ºæœå™¨</strong>
                    <ul style="margin-top: 8px;">
                        <li>ğŸŒŸ <strong>æ¨è–¦</strong>ï¼šé›™æ“ŠåŸ·è¡Œ <code>å•Ÿå‹•ä¼ºæœå™¨.bat</code>ï¼ˆæœƒè‡ªå‹•é¡¯ç¤ºç¶²å€æç¤ºï¼‰</li>
                        <li>æˆ–æ‰‹å‹•åŸ·è¡Œï¼š<code>python -m http.server 9527</code>ï¼Œç„¶å¾Œåœ¨ç€è¦½å™¨é–‹å•Ÿ <code>http://localhost:9527/index.html</code></li>
                    </ul>
                </li>
                <li>ä¸Šå‚³æ‚¨çš„ 360Â° å…¨æ™¯åœ–ï¼ˆç­‰è·åœ“æŸ±æŠ•å½±æ ¼å¼ï¼Œå»ºè­° 2:1 æ¯”ä¾‹ï¼‰</li>
                <li>é è¦½ç¢ºèªå¾Œï¼Œé»æ“Šã€Œç”Ÿæˆ GLB æª”æ¡ˆã€</li>
                <li>ç³»çµ±æœƒè‡ªå‹•ä¸‹è¼‰ <strong>skybox.glb</strong>ï¼Œå¯ç›´æ¥ä¸Šå‚³åˆ° VR ç·¨è¼¯å™¨ä½¿ç”¨</li>
            </ol>
        </div>

        <!-- ä½œè€…è³‡è¨Š -->
        <div class="author-section">
            <div class="author-content">
                <img src="ä½œè€…è³‡è¨Š.png" alt="æ›¾æ…¶è‰¯ ä¸»ä»»" class="author-image">
                <div class="author-info">
                    <h3>ğŸ‘¨â€ğŸ« é—œæ–¼ä½œè€… - æ›¾æ…¶è‰¯ ä¸»ä»»ï¼ˆé˜¿äº®è€å¸«ï¼‰</h3>
                    <p>ğŸ“Œ æ–°èˆˆç§‘æŠ€æ¨å»£ä¸­å¿ƒä¸»ä»»</p>
                    <p>ğŸ“Œ æ•™è‚²éƒ¨å­¸ç§‘ä¸­å¿ƒæ‰€é•·æ•™å¸«</p>
                    <p>ğŸ“Œ è‡ºåŒ—å¸‚èªæ–‡å­¸ç¿’é ˜åŸŸè¼”å°å“¡</p>
                    <p>ğŸ† 2024å¹´ ç²æ•™è‚²éƒ¨äººå·¥æ™ºæ…§è¬›å¸«èªè­‰</p>
                    <p>ğŸ† 2022ã€2023å¹´ æŒ‡å°å­¸ç”ŸXRå°ˆé¡Œç«¶è³½ç²ç‰¹å„ª</p>
                    <p>ğŸ† 2022å¹´ ç²VRæ•™æé–‹ç™¼æ•™å¸«çµ„ç‰¹å„ª</p>
                    <p>ğŸ† 2019å¹´ ç²ç™¾å¤§è³‡è¨Šäººæ‰ç</p>
                    <p>ğŸ† 2018ã€2019èŸ¬è¯å¤©ä¸‹å‰µæ–°100æ•™å¸«</p>

                    <div class="social-links">
                        <a href="https://www.youtube.com/@Liang-yt02" target="_blank" class="social-link">
                            ğŸ“º YouTube é »é“
                        </a>
                        <a href="https://www.facebook.com/groups/2754139931432955?locale=zh_TW" target="_blank" class="social-link">
                            ğŸ‘¥ 3Aç§‘æŠ€ç ”ç©¶ç¤¾
                        </a>
                        <a href="mailto:3a01chatgpt@gmail.com" class="social-link">
                            ğŸ“§ èª²ç¨‹é‚€ç´„
                        </a>
                    </div>
                </div>
            </div>

            <!-- æˆæ¬Šè²æ˜ -->
            <div class="license-section">
                <h4>ğŸ“œ æˆæ¬Šè²æ˜</h4>
                <p class="copyright">Â© 2026 é˜¿äº®è€å¸« ç‰ˆæ¬Šæ‰€æœ‰</p>
                <p>æœ¬å°ˆæ¡ˆåƒ…ä¾›ã€Œé˜¿äº®è€å¸«èª²ç¨‹å­¸å“¡ã€å­¸ç¿’ä½¿ç”¨ã€‚</p>
                <p class="warning">âš ï¸ ç¦æ­¢äº‹é …ï¼š</p>
                <ul>
                    <li>ç¦æ­¢ä¿®æ”¹æœ¬å°ˆæ¡ˆå…§å®¹</li>
                    <li>ç¦æ­¢è½‰å‚³æˆ–æ•£å¸ƒ</li>
                    <li>ç¦æ­¢å•†æ¥­ä½¿ç”¨</li>
                    <li>ç¦æ­¢æœªç¶“æˆæ¬Šä¹‹ä»»ä½•å½¢å¼ä½¿ç”¨</li>
                </ul>
                <p style="margin-top: 10px; font-size: 13px;">å¦‚æœ‰ä»»ä½•æˆæ¬Šéœ€æ±‚ï¼Œè«‹è¯ç¹«ä½œè€…ã€‚</p>
            </div>
        </div>
    </div>

    <!-- ä½¿ç”¨ ES6 æ¨¡çµ„æ–¹å¼è¼‰å…¥ Three.js -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
        }
    }
    </script>

    <script type="module">
        // å°å…¥ Three.js å’Œç›¸é—œæ¨¡çµ„
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        import { GLTFExporter } from 'three/addons/exporters/GLTFExporter.js';

        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const previewSection = document.getElementById('previewSection');
        const previewImage = document.getElementById('previewImage');
        const imageName = document.getElementById('imageName');
        const imageSize = document.getElementById('imageSize');
        const convertBtn = document.getElementById('convertBtn');
        const changeImageBtn = document.getElementById('changeImageBtn');
        const status = document.getElementById('status');
        const gltfStatus = document.getElementById('gltfStatus');
        const binStatus = document.getElementById('binStatus');

        // æª”æ¡ˆè·¯å¾‘
        const FILES = {
            gltf: 'Spatial Skybox Sample.gltf',
            bin: 'Spatial Skybox Sample.bin'
        };

        let sampleFilesReady = false;
        let uploadedImageFile = null;
        let uploadedImageDataURL = null;

        // å•Ÿå‹•ç•«é¢çµæŸå¾Œå†æª¢æŸ¥ Sample æª”æ¡ˆ
        setTimeout(() => {
            checkSampleFiles();
        }, 4000);

        // æª¢æŸ¥ Sample æª”æ¡ˆ
        async function checkSampleFiles() {
            const checks = [
                checkFile(FILES.gltf, gltfStatus),
                checkFile(FILES.bin, binStatus)
            ];

            const results = await Promise.all(checks);
            sampleFilesReady = results.every(r => r);

            if (sampleFilesReady) {
                showStatus('success', 'âœ… ç’°æ™¯çƒæ¨¡æ¿è¼‰å…¥æˆåŠŸï¼è«‹ä¸Šå‚³æ‚¨çš„ 360Â° å…¨æ™¯åœ–ã€‚');
            } else {
                showStatus('error', 'âŒ æ¨¡æ¿æª”æ¡ˆè¼‰å…¥å¤±æ•—ï¼Œè«‹ç¢ºèª Sample æª”æ¡ˆæ˜¯å¦å­˜åœ¨æ–¼åŒä¸€ç›®éŒ„ã€‚');
            }
        }

        // æª¢æŸ¥å–®ä¸€æª”æ¡ˆ
        async function checkFile(filename, statusElement) {
            try {
                const response = await fetch(filename + '?t=' + Date.now());
                if (response.ok) {
                    statusElement.classList.add('loaded');
                    statusElement.querySelector('.file-status-text').textContent = 'âœ“ å·²è¼‰å…¥';
                    return true;
                } else {
                    throw new Error('æª”æ¡ˆä¸å­˜åœ¨');
                }
            } catch (error) {
                statusElement.classList.add('error');
                statusElement.querySelector('.file-status-text').textContent = 'âœ— è¼‰å…¥å¤±æ•—';
                return false;
            }
        }

        // ä¸Šå‚³å€åŸŸäº‹ä»¶
        uploadArea.addEventListener('click', () => fileInput.click());

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleImageUpload(files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleImageUpload(e.target.files[0]);
            }
        });

        // æ›´æ›åœ–ç‰‡
        changeImageBtn.addEventListener('click', () => {
            fileInput.click();
        });

        // è™•ç†åœ–ç‰‡ä¸Šå‚³
        function handleImageUpload(file) {
            if (!file.type.match('image/(jpeg|jpg|png)')) {
                showStatus('error', 'âŒ è«‹é¸æ“‡ JPG æˆ– PNG æ ¼å¼çš„åœ–ç‰‡ï¼');
                return;
            }

            if (!sampleFilesReady) {
                showStatus('error', 'âŒ æ¨¡æ¿æª”æ¡ˆå°šæœªè¼‰å…¥ï¼Œè«‹ç¨å€™å†è©¦ã€‚');
                return;
            }

            uploadedImageFile = file;

            const reader = new FileReader();
            reader.onload = (e) => {
                uploadedImageDataURL = e.target.result;
                previewImage.src = uploadedImageDataURL;
                imageName.textContent = file.name;
                imageSize.textContent = formatFileSize(file.size);

                uploadArea.style.display = 'none';
                previewSection.style.display = 'block';
                showStatus('success', 'âœ… åœ–ç‰‡ä¸Šå‚³æˆåŠŸï¼å¯ä»¥é–‹å§‹ç”Ÿæˆ GLB äº†ã€‚');
            };
            reader.readAsDataURL(file);
        }

        // æ ¼å¼åŒ–æª”æ¡ˆå¤§å°
        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(2) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(2) + ' MB';
        }

        // ç”Ÿæˆ GLB
        convertBtn.addEventListener('click', generateGLB);

        async function generateGLB() {
            if (!sampleFilesReady) {
                showStatus('error', 'âŒ æ¨¡æ¿æª”æ¡ˆå°šæœªæº–å‚™å¥½ã€‚');
                return;
            }

            if (!uploadedImageDataURL) {
                showStatus('error', 'âŒ è«‹å…ˆä¸Šå‚³åœ–ç‰‡ï¼');
                return;
            }

            showStatus('processing', 'ğŸ”„ æ­£åœ¨ç”Ÿæˆ GLBï¼Œè«‹ç¨å€™...');
            convertBtn.disabled = true;

            try {
                // è®€å– glTF æª”æ¡ˆ
                const gltfResponse = await fetch(FILES.gltf + '?t=' + Date.now());
                const gltfText = await gltfResponse.text();
                const gltfJson = JSON.parse(gltfText);

                // è®€å– .bin æª”æ¡ˆ
                const binResponse = await fetch(FILES.bin + '?t=' + Date.now());
                const binArrayBuffer = await binResponse.arrayBuffer();

                // å»ºç«‹ Blob URLs
                const binBlob = new Blob([binArrayBuffer], { type: 'application/octet-stream' });
                const binURL = URL.createObjectURL(binBlob);

                // ä¿®æ”¹ glTF JSONï¼Œæ›¿æ›è²¼åœ–ç‚ºç”¨æˆ¶ä¸Šå‚³çš„åœ–ç‰‡
                if (gltfJson.buffers && gltfJson.buffers[0]) {
                    gltfJson.buffers[0].uri = binURL;
                }

                if (gltfJson.images && gltfJson.images[0]) {
                    gltfJson.images[0].uri = uploadedImageDataURL;
                }

                // å»ºç«‹ glTF Blob
                const gltfBlob = new Blob([JSON.stringify(gltfJson)], { type: 'application/json' });
                const gltfURL = URL.createObjectURL(gltfBlob);

                // ä½¿ç”¨ GLTFLoader è¼‰å…¥
                const loader = new GLTFLoader();

                loader.load(
                    gltfURL,
                    function(gltf) {
                        // è¼‰å…¥æˆåŠŸï¼Œé–‹å§‹å°å‡ºç‚º GLB
                        const exporter = new GLTFExporter();

                        exporter.parse(
                            gltf.scene,
                            function(glbArrayBuffer) {
                                // ä¸‹è¼‰ GLB æª”æ¡ˆ
                                const glbBlob = new Blob([glbArrayBuffer], { type: 'application/octet-stream' });
                                downloadFile(glbBlob, 'skybox.glb');

                                showStatus('success', 'ğŸ‰ ç”Ÿæˆå®Œæˆï¼skybox.glb å·²ä¸‹è¼‰ï¼Œå¯ä»¥ä¸Šå‚³åˆ° VR ç·¨è¼¯å™¨äº†ï¼');
                                convertBtn.disabled = false;

                                // æ¸…ç† Blob URLs
                                URL.revokeObjectURL(gltfURL);
                                URL.revokeObjectURL(binURL);
                            },
                            function(error) {
                                console.error('å°å‡º GLB æ™‚ç™¼ç”ŸéŒ¯èª¤:', error);
                                showStatus('error', 'âŒ å°å‡ºå¤±æ•—ï¼š' + error.message);
                                convertBtn.disabled = false;
                            },
                            {
                                binary: true,
                                embedImages: true
                            }
                        );
                    },
                    function(progress) {
                        if (progress.total > 0) {
                            const percent = (progress.loaded / progress.total) * 100;
                            showStatus('processing', `ğŸ”„ è¼‰å…¥ä¸­... ${Math.round(percent)}%`);
                        }
                    },
                    function(error) {
                        console.error('è¼‰å…¥ glTF æ™‚ç™¼ç”ŸéŒ¯èª¤:', error);
                        showStatus('error', 'âŒ è¼‰å…¥å¤±æ•—ï¼š' + error.message);
                        convertBtn.disabled = false;
                    }
                );

            } catch (error) {
                console.error('ç”Ÿæˆéç¨‹ç™¼ç”ŸéŒ¯èª¤:', error);
                showStatus('error', 'âŒ ç”Ÿæˆå¤±æ•—ï¼š' + error.message);
                convertBtn.disabled = false;
            }
        }

        // ä¸‹è¼‰æª”æ¡ˆ
        function downloadFile(blob, filename) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // é¡¯ç¤ºç‹€æ…‹è¨Šæ¯
        function showStatus(type, message) {
            status.className = 'status ' + type;
            status.textContent = message;
            status.style.display = 'block';
        }

        // å•Ÿå‹•ç•«é¢è‡ªå‹•ç§»é™¤
        setTimeout(() => {
            const splashScreen = document.getElementById('splash-screen');
            if (splashScreen) {
                splashScreen.remove();
            }
        }, 4500);
    </script>
    </div> <!-- é—œé–‰ main-content -->
</body>
</html>
